{extend name="extra@phone/main"}

{block name="header"}

<style>
    .icon-img{
        width: 34px;
    }
    .re_bt{
        border: 1px solid orange;
        text-align: center;
        border-radius: 10px;
        background: orange;
    }
    .zhang{
        background: url("__STATIC__/plugs/proom/img/gr_bg.png");
        background-size:100%
    }
</style>
{/block}

{block name="body"}


<!--top-->
<div class="top_c">
    <p class="titi">钱包</p>
</div>

<!--头部-->
<div class="rec_tou"  style="height: 130px;">
    <div style="float: left; height: 100%; width: 48%">

        <div class="rec_z">
            <span style="color: #000000">可用余额（元）</span>
            <b style="color: #000000">{$user_coin}</b>
        </div>
    </div>

    <div style="float: left; height: 100%; width: 48%">
        <div class="rec_z" >
            <span style="color: #000000">剩余娃娃币</span>
            <b style="color: #000000">{$free_coin}</b>
        </div>
    </div>
</div>

<!--列表-->
<div class="lie_b">
    <div class="container">
        <div class="one">
            <a data-href='{:url("phone/wallet/recharge")}' href="javascript:void(0)">
                <p class="biao"><span class="iconfont icon-chongzhi"></span>充值<i class="iconfont icon-jiantou"></i></p>
            </a>
        </div>
        <div class="one" style="border-bottom:none;">
            <a data-href='{:url("phone/wallet/outCash")}' href="javascript:void(0)">
                <p class="biao"><span class="iconfont icon-tixian1"></span>提现<i class="iconfont icon-jiantou"></i></p>
            </a>
        </div>
    </div>
</div>

<div class="lie_b">
    <div class="container">
        <div class="one">
            <a data-href='{:url("phone/wallet/bill")}?type=3' href="javascript:void(0)">
                <p class="biao"><span class="iconfont"><img src="__STATIC__/plugs/proom/img/income.png" class="icon-img"/></span>
                    收益记录<i class="iconfont icon-jiantou"></i>
                </p>
            </a>
        </div>
        <div class="one" >
            <a data-href='{:url("phone/wallet/bill")}?type=1' href="javascript:void(0)">
                <p class="biao"><span class="iconfont"><img src="__STATIC__/plugs/proom/img/qbdd.png" class="icon-img"/></span>
                    充值账单<i class="iconfont icon-jiantou"></i>
                </p>
            </a>
        </div>
        <div class="one" style="border-bottom:none;">
            <a data-href='{:url("phone/wallet/bill")}?type=2' href="javascript:void(0)">
                <p class="biao"><span class="iconfont"><img src="__STATIC__/plugs/proom/img/qbdd.png" class="icon-img"/></span>
                    消费账单<i class="iconfont icon-jiantou"></i>
                </p>
            </a>
        </div>
    </div>
</div>


<script src="__STATIC__/plugs/phone/js/jquery.min.js" type="text/javascript"></script>

<script src="__STATIC__/plugs/phone/js/bootstrap.min.js" type="text/javascript"></script>
<script src="__STATIC__/plugs/phone/js/index.js" type="text/javascript"></script>

<script>

    var  mini_send = function(){

        var perOrderPara = '';
        var perObj = '';
        $.ajax("{:url('phone/wallet/recharge')}", {
            dataType: 'json', method: 'post', data: '11',
            success: function (ret) {

                //预订单参数
                perOrderPara = ret;

                if( perOrderPara.length <= 0 ){
                    alert('order para is null');
                    perObj = 'order para is null';
                }else{
                    alert('order =' + perOrderPara);
                    var perObj = JSON.parse(perOrderPara);
                }

                //异常判断 处理
               /* if( !perObj.code){
                    if(perObj.code == 2){

                    }

                    return;
                }*/

        require(['phone.jweixin'], function (wx) {
            console.log(wx)
            wx.miniProgram.getEnv(function(res) {
                        var isMini =  res.miniprogram;

                        console.log(isMini) // true
                    }
            );
            //点击微信支付后，调取统一下单接口生成微信小程序支付需要的支付参数
            var packageArr = perObj.package.split("=");
            var prePayId = packageArr[1];
            var params = '?timestamp=' + perObj.timeStamp + '&nonceStr=' + perObj.nonceStr
                    + '&signType=' + perObj.signType + '&paySign=' + perObj.paySign
                    + '&prePayId=' + prePayId + '&order_no=' + perObj.order_no;


            var path = '/pages/wxpay/wxpay' + params;
            wx.miniProgram.navigateTo({
                url: path,
                success: function(){
                    console.log('success')
                },
                fail: function(){
                    console.log('fail');
                },
                complete:function(){
                    console.log('complete');
                }

            });

        })

        }
    });

    }

</script>

{/block}